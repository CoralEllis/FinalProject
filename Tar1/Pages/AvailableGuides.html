<!DOCTYPE html>
<html>
<head>
    <link href="../Style.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <meta charset="utf-8" />
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
    <script type="text/javascript"></script>
    <script src="../Scripts/ajaxCalls.js"></script>
    <script src="../Scripts/moment.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script src="../Scripts/moment.js"></script>
    <script src="../Scripts/moment.js"></script>
    <title>רשימת מדריכים פנויים לאיוש משמרות</title>
    <script>
        unit = 0;
        ShiftsArray = [];
        function gets() {
            ajaxCall("GET", "../api/OrganizeUnit", "", GetOrganizeUnitS, error);

        }
        function GetOrganizeUnitS(data) {
            str = "<option>בחר יחידה ארגונית</option>";
            for (var i = 0; i < data.length; i++) {
                str += "<option value='" + data[i].Id + "'>" + data[i].Unitname + "</option>"
            }
            $("#SelectUnit").html(str);
        }
        function error(err) {
            console.log(err);
        }
        function GetWorkSchedule(select) {
            id = select.options[select.selectedIndex].value;
            unit = id.toString();
            //ajaxCall("GET", "../api/Period/Id?id=" + unit, "", GETOfficialS, error);
            ajaxCall("GET", "../api/Official/Unit?unit=" + unit, "", GETOfficialS, error);
        }
        function GETOfficialS(data) {
            console.log(data);
            for (var i = 0; i < data.length; i++) {
                d = data[i].Shiftdate.split("T");
                x = data[i].Startshifthour.split("T");
                y = data[i].Endshifthour.split("T");
                shiftdatestart = d[0] + " " + x[1];
                shiftdateend = d[0] + " " + y[1];
                shift = {
                    "Type": data[i].Shifttype,
                    "StartShift": moment(shiftdatestart),
                    "EndShift": moment(shiftdateend),
                    //"Guidenum": data[i].Numofguides,
                    "NuminOfficialShift": []
                }
                ShiftsArray.push(shift);
            }
            ShiftsArray.sort(sortByDateAsc);
            $("#Emptyshifts").show();
        }
        sortByDateAsc = function (lhs, rhs) { return lhs.StartShift > rhs.StartShift ? 1 : lhs.StartShift < rhs.StartShift ? -1 : 0 }

    </script>
</head>
<body dir="rtl" style="background-color:aliceblue" onload="gets()">

    <img src="../Photos/LOGO.PNG" />
    <div class="container-fluid" id="SubmShift">

        <h1> איוש מדריכים למשמרות</h1><br />
        <div class="row">
            <h3> בחר יחידה ארגונית שברצונך לאייש עבורה משמרת  </h3>
            <select id="SelectUnit" onchange="GetWorkSchedule(this)"></select>
            <select id="scheduelPeriod"> </select>
            <div id="Emptyshifts" style="display:none">
            <h3>להלן כל המשמרות הלא מאויישות בתקופת השיבוץ</h3>
         
            </div>


        </div>
        
        <div class="row" id="submitshift" dir="rtl">
            <div class="col" id="0">
                <label> א'</label>
            </div>
            <div class="col" id="1">
                <label> ב'</label>
            </div>
            <div class="col" id="2">
                <label> ג'</label>
            </div>
            <div class="col" id="3">
                <label> ד'</label>
            </div>
            <div class="col" id="4">
                <label> ה'</label>
            </div>
            <div class="col" id="5">
                <label> ו'</label>
            </div>
            <div class="col" id="6">
                <label> ש'</label>
            </div>
        </div><br /><br />


    </div>
</body>
</html>